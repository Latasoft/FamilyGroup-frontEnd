<section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
  <ng-container *ngFor="let property of properties">
    <article 
      class="bg-white rounded-lg shadow-md p-4 relative" 
      [class.cursor-pointer]="!isAdmin"
      (click)="!isAdmin ? navigateToDetail(property._id) : null">
      
      <!-- Botón de eliminar (basurero) en la esquina superior derecha -->
      <button 
        *ngIf="isAdmin && !property.is_activated" 
        (click)="onDropProperty(property._id); $event.stopPropagation()" 
        class="absolute top-2 right-2 text-red-500 hover:text-red-700 bg-white rounded-full p-1 shadow-sm z-10">
        <!-- Icono de basurero SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
      </button>

      <!-- Imagen de la propiedad -->
      <figure class="w-full h-[200px] bg-gray-200 rounded-lg mb-4 overflow-hidden">
        <img
          *ngIf="property.foto_casa && property.foto_casa.length > 0; else noImage"
          [src]="property.foto_casa.length > 0 ? property.foto_casa[0].url : 'assets/images/default.jpg'"
          alt="{{ property.nombre }}"
          class="w-full h-full object-cover"
        />
        <ng-template #noImage>
          <div class="no-image-placeholder">
            Imagen no disponible
          </div>
        </ng-template>
      </figure>

      <!-- Información de la propiedad -->
      <header>
        <h2 class="text-lg font-bold mb-2 text-center">{{ property.nombre }}</h2>
      </header>
      <p class="text-sm text-black font-bold flex items-end">
        <img src="assets/images/location.svg" class="w-4 h-4 mr-3" alt="Location Icon" />{{ property.comuna }}
      </p>
      <section class="flex items-center gap-4 mt-4">
        <!-- Icono de habitaciones -->
        <div class="flex items-center justify-center relative">
          <img
            src="assets/images/king_bed.svg"
            alt="Bed Icon"
            class="w-6 h-6 mr-2"
          />
          <span
            class="absolute top-0 right-0 transform translate-x-[50%] -translate-y-[50%] bg-[#1E2D5B] text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center text-[9px] p-2"
          >
            {{ property.dormitorios }}
          </span>
        </div>

        <!-- Icono de baños -->
        <div class="flex items-center justify-center relative">
          <img
            src="assets/images/shower.svg"
            alt="Bathroom Icon"
            class="w-6 h-6 mr-2"
          />
          <span
            class="absolute top-0 right-0 transform translate-x-[50%] -translate-y-[50%] bg-[#1E2D5B] text-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center text-[9px] p-2"
          >
            {{ property.banos }}
          </span>
        </div>

        <!-- Área -->
        <div class="flex items-center gap-1 text-sm">
          <img
            src="assets/images/drawing.svg"
            alt="Area Icon"
            class="w-6 h-6"
          />
          <span>{{ property.superficie }}</span>
        </div>
      </section>

      <!-- Botones de administración - Solo visibles para admin -->
      <footer *ngIf="isAdmin" class="flex justify-end gap-2 mt-3" (click)="$event.stopPropagation()">
        <button (click)="onEditProperty(property._id)" class="text-blue-500">Editar</button>
        
        <button *ngIf="property.is_activated" 
                (click)="onDeleteProperty(property._id)" 
                class="text-red-500 hover:text-red-700">
          Desactivar
        </button>
        
        <button *ngIf="!property.is_activated" 
                (click)="onRestoreProperty(property._id)" 
                class="text-green-500 hover:text-green-700">
          Activar
        </button>
      </footer>
    </article>
  </ng-container>
</section>